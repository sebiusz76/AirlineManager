@model AirlineManager.Models.ViewModel.ChangePasswordViewModel

@{
	ViewData["Title"] = "Change Password";
	var mustChangePassword = ViewBag.MustChangePassword as bool? ?? false;
	var isExpired = ViewBag.IsPasswordExpired as bool? ?? false;
	var daysUntilExpiration = ViewBag.DaysUntilPasswordExpiration as int?;
}

<h1><i class="bi bi-key"></i> Change Password</h1>

@if (mustChangePassword)
{
	<div class="alert alert-warning">
		<i class="bi bi-exclamation-triangle"></i> <strong>Password change required.</strong>
		An administrator has flagged your account for a password change. Please set a new password to continue.
	</div>
}
else if (isExpired)
{
	<div class="alert alert-danger">
		<i class="bi bi-shield-exclamation"></i> <strong>Your password has expired.</strong>
		For security reasons, you must change your password to continue using your account.
	</div>
}
else if (daysUntilExpiration.HasValue && daysUntilExpiration.Value <= 7 && daysUntilExpiration.Value > 0)
{
	<div class="alert alert-info">
		<i class="bi bi-info-circle"></i> <strong>Password expiring soon.</strong>
		Your password will expire in <strong>@daysUntilExpiration.Value day(s)</strong>. Consider changing it now to avoid interruption.
	</div>
}

<form asp-action="ChangePassword" method="post" class="edit-form">
	@Html.AntiForgeryToken()
	<div class="mb-3">
		<label asp-for="NewPassword" class="form-label"></label>
		<input asp-for="NewPassword" class="form-control" />
		<span asp-validation-for="NewPassword" class="text-danger"></span>
	</div>
	<div class="mb-3">
		<label asp-for="ConfirmPassword" class="form-label"></label>
		<input asp-for="ConfirmPassword" class="form-control" />
		<span asp-validation-for="ConfirmPassword" class="text-danger"></span>
	</div>

	@if (ViewBag.PasswordRequirements != null && ((List<string>)ViewBag.PasswordRequirements).Any())
	{
		<div class="alert alert-info">
			<i class="bi bi-info-circle"></i>
			<strong>Password requirements:</strong>
			<ul class="mb-0 mt-2">
				@foreach (var requirement in (List<string>)ViewBag.PasswordRequirements)
				{
					<li>@requirement</li>
				}
			</ul>
		</div>
	}

	<button type="submit" class="btn btn-primary">
		<i class="bi bi-check-circle"></i> Change password
	</button>
</form>

@section Scripts {
	<partial name="_ValidationScriptsPartial" />
}
